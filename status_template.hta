<html>
<head>
<title>WhisperX Launcher Status</title>
<HTA:APPLICATION
  ID="WhisperXStatus"
  APPLICATIONNAME="WhisperX Launcher Status"
  BORDER="thin"
  BORDERSTYLE="normal"
  CAPTION="yes"
  SHOWINTASKBAR="yes"
  SINGLEINSTANCE="yes"
  SYSMENU="yes"
  WINDOWSTATE="normal"
/>
<style>
  body {
    font-family: Consolas, monospace;
    font-size: 12pt;
    background-color: #f4f4f4;
    color: #222;
    margin: 0;
    padding: 10px;
  }
  #status {
    white-space: pre-wrap;
    word-wrap: break-word;
  }
</style>
<script language="VBScript">
Option Explicit

Dim logPath

Sub Window_OnLoad()
  ' The launcher replaces {{TEMP_LOG}} with the actual log file path
  logPath = "{{TEMP_LOG}}"

  ' Resize and center the window
  Dim w, h
  w = 520
  h = 140
  window.resizeTo w, h
  window.moveTo (screen.availWidth - w) \ 2, (screen.availHeight - h) \ 2

  ' Start polling every second
  window.setInterval "UpdateStatus", 1000
End Sub

Sub UpdateStatus()
  On Error Resume Next
  Dim fso, ts, line, lastLine
  Set fso = CreateObject("Scripting.FileSystemObject")
  If fso.FileExists(logPath) Then
    Set ts = fso.OpenTextFile(logPath, 1, False, -1) ' -1 = Unicode/UTF-8
    lastLine = ""
    Do Until ts.AtEndOfStream
      line = ts.ReadLine
      If Len(line) > 0 Then lastLine = line
    Loop
    ts.Close
    If lastLine <> "" Then
      document.getElementById("status").innerText = lastLine
    End If
  Else
    document.getElementById("status").innerText = "Waiting for status log..."
  End If
  On Error GoTo 0
End Sub
</script>
</head>
<body>
  <div id="status">Initializing...</div>
</body>
</html>